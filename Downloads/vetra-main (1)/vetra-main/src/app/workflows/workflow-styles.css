/* Styles pour le Workflow Builder - Fluidité et animations */

@import '@xyflow/react/dist/style.css';

/* Animation des edges (connexions) */
.react-flow__edge {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.react-flow__edge-path {
  stroke-dasharray: 5;
  animation: dashdraw 0.5s linear infinite;
  transition: stroke 0.3s ease;
}

.react-flow__edge.selected .react-flow__edge-path {
  stroke: #a855f7;
  stroke-width: 3;
  filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.6));
}

.react-flow__edge.animated .react-flow__edge-path {
  stroke: #8b5cf6;
  animation: dashdraw 0.5s linear infinite, pulse 2s ease-in-out infinite;
}

@keyframes dashdraw {
  to {
    stroke-dashoffset: -10;
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

/* Animation des nodes */
.react-flow__node {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: grab;
}

.react-flow__node:active {
  cursor: grabbing;
}

.react-flow__node.selected {
  filter: drop-shadow(0 0 12px rgba(168, 85, 247, 0.8));
  transform: scale(1.02);
}

.react-flow__node.dragging {
  opacity: 0.8;
  transform: scale(1.05);
  z-index: 1000;
}

/* Animation d'exécution */
.react-flow__node.executing {
  animation: executing-pulse 1s ease-in-out infinite;
  box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
}

.react-flow__node.completed {
  opacity: 0.7;
  filter: brightness(1.2);
}

@keyframes executing-pulse {
  0%, 100% {
    box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 30px rgba(16, 185, 129, 0.9);
    transform: scale(1.03);
  }
}

/* Animation des handles (points de connexion) */
.react-flow__handle {
  width: 10px;
  height: 10px;
  background: #8b5cf6;
  border: 2px solid #1f2937;
  transition: all 0.2s ease;
}

.react-flow__handle:hover {
  width: 14px;
  height: 14px;
  background: #a855f7;
  box-shadow: 0 0 10px rgba(168, 85, 247, 0.8);
}

.react-flow__handle.connecting {
  background: #10b981;
  animation: handle-pulse 0.6s ease-in-out infinite;
}

@keyframes handle-pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.3);
  }
}

/* Background animé */
.react-flow__background {
  opacity: 0.3;
  transition: opacity 0.3s ease;
}

.react-flow__background:hover {
  opacity: 0.5;
}

/* Controls stylisés */
.react-flow__controls {
  background: rgba(31, 41, 55, 0.9) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 8px !important;
  backdrop-filter: blur(10px);
}

.react-flow__controls-button {
  background: transparent !important;
  border: none !important;
  color: #fff !important;
  transition: all 0.2s ease !important;
}

.react-flow__controls-button:hover {
  background: rgba(139, 92, 246, 0.2) !important;
  transform: scale(1.1);
}

/* MiniMap stylisé */
.react-flow__minimap {
  background: rgba(31, 41, 55, 0.9) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 8px !important;
  backdrop-filter: blur(10px);
}

/* Animation de connexion en temps réel */
.edge-connecting {
  stroke-dasharray: 5;
  animation: dashdraw 0.3s linear infinite;
  stroke: #10b981;
}

/* Glow effect sur les nodes actifs */
.node-active-glow {
  filter: drop-shadow(0 0 15px rgba(139, 92, 246, 0.8));
  animation: glow-pulse 2s ease-in-out infinite;
}

@keyframes glow-pulse {
  0%, 100% {
    filter: drop-shadow(0 0 15px rgba(139, 92, 246, 0.8));
  }
  50% {
    filter: drop-shadow(0 0 25px rgba(139, 92, 246, 1));
  }
}

/* Transition fluide pour les changements de position */
.react-flow__node {
  will-change: transform;
}

/* Smooth scrolling */
.react-flow__viewport {
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Animation de drop */
@keyframes drop-in {
  0% {
    opacity: 0;
    transform: scale(0.8) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.node-drop-animation {
  animation: drop-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Animation de connexion */
@keyframes connection-draw {
  from {
    stroke-dashoffset: 100;
  }
  to {
    stroke-dashoffset: 0;
  }
}

.edge-new {
  animation: connection-draw 0.5s ease-out;
}

